/*!
 * Helper script for Anyway Feedback
 *
 * @package AnywayFeedback
 */
jQuery(document).ready((function(t){const e=function(t,e){let a=Cookies.get(n(t));return!!a&&("string"!=typeof a&&(a=a.toString()),a=a.replace(/[^0-9,]/g,""),a=a.split(","),!(a.indexOf(e.toString())<0))},n=function(t){return"afb_"+("comment"===t?"comment":"post")},a=t(".afb_container");a.each((function(n,a){const s=parseInt(t(a).find("input[name=object_id]").val()),i=t(a).find("input[name=post_type]").val();e(i,s)&&(t(a).find("a, input").remove(),t(a).find(".message").text(AFBP.already),t(a).addClass("afb_posted"))})),a.on("click","a",(function(a){a.preventDefault();const s=t(this).parent(".afb_container");if(!s.hasClass("afb_posted")){const a=parseInt(s.find("input[name=object_id]").val()),i=s.find("input[name=post_type]").val(),o=t(this).hasClass("bad")?0:1;wp.apiFetch({path:"afb/v1/feedback/"+i+"/"+a,data:{affirmative:o},method:"post"}).then((function(t){if(s.find("a, .input").remove(),s.find(".message").addClass("success").text(t.message),s.find(".status").text(t.status),function(t,a){if(!e(t,a)){let e=Cookies.get(n(t));e?("string"!=typeof e&&(e=e.toString()),e=e.split(",")):e=[],e.push(parseInt(a)),Cookies.set(n(t),e.join(","),{expires:730,path:"/"})}}(i,a),"1"===AFBP.ga)try{gtag("event","feedback",{type:"comment"===i?"comment":"post",id:a,value:o?1:-1})}catch(t){}s.trigger("feedback.afb",["comment"===i?"comment":"post",a,o])})).catch((function(t){s.find("a, .input").remove(),s.find(".message").addClass("error").text(t.message)}))}}))}));